# 2021年情報システム設計 要求仕様書
## 卓球戦績管理システム

### 改版履歴

|作成日|編集者|版数|改版内容|
|:---:|:---:|:---:|:---|
|2021/7/10|楢崎なゆ|初版|初版作成|
|2021/7/15|楢崎なゆ|二版|ユースケース記述を追加|
|2021/7/20|楢崎なゆ|三版|データベース設計を変更|
|2021/7/25|楢崎なゆ|四版|ユースケース記述を変更

### 用語の定義

|用語|定義|
|:---:|:---|
|システム|今回，この要求仕様書に基づいて作成する卓球戦績管理システムのこと|
|ユーザー|本システムの利用者のこと，機能を利用するためにはアカウントの作成が必須となる|
|アカウント|氏名，メールアドレス，パスワード，秘密の質問の選択およびその答えからなる|

### システムの概要
### 1. 目的
　ユーザーが卓球の対戦結果を入力し，自身の戦績を管理できる．管理している自身の戦績は，対戦相手を指定して検索できる．<br>　なお，この戦績管理システムは個人での利用を想定している．

### 2. 機能要件
##### 2-1. アカウント新規登録機能
トップページの「新規登録」を押すとアカウント作成画面に遷移する．<br>
新規登録に成功すると新規登録成功画面に遷移する．

##### 2-2. ログイン機能
トップ画面の「ログイン」を押すとログイン画面に遷移する．<br>
ログインに成功するとログイン成功画面に遷移する．

##### 2-3. 試合情報登録機能
マイページの「試合情報登録」を押すと試合情報登録画面に遷移する．<br>
試合情報登録に成功すると登録成功画面に遷移する．

##### 2-4. 対戦相手登録機能
マイページの「相手登録」を押すと相手情報登録画面に遷移する．<br>
相手情報登録に成功すると登録成功画面に遷移する．

##### 2-5. 対戦結果登録機能
トップページから「対戦結果登録」を押すと対戦結果登録画面に遷移する．<br>
結果登録に成功すると登録成功画面に遷移する．

##### 2-6. 対戦結果検索機能
対戦結果検索画面から対戦相手を選択し，「検索」を押すと検索結果画面に遷移する．

##### 2-7. 対戦結果削除機能
対戦結果画面から削除したい対戦の「削除」を押すと削除される．

##### 2-8. ログアウト機能
マイページの「ログアウト」を押すと，ログアウト画面に遷移する．

##### 2-9. パスワード変更機能
ログイン画面，またはマイページの「パスワード変更」を押すとパスワード変更画面に遷移する．<br>
新しく設定したいパスワードを入力してもらい，新規登録の際に設定した秘密の質問に答えてもらう．<br>
答えがあっていたら再設定に成功し，ログイン画面に遷移する．

### 3. ユースケース記述
##### 3-1.  ユーザー情報を登録する

|項目|内容|
|:---|:---|
|概要|アカウントを作成したいユーザーの情報をシステムに登録する|
|アクター|ユーザー|
|事前条件||
|基本系列|1.システムはアカウント新規登録画面を表示する<br>2.ユーザーは氏名，メールアドレス，パスワードを入力し，秘密の質問を選択およびその答えを入力し，それらを登録する<br>3.システムはアカウントを新規作成する<br>4.システムはアカウント登録完了画面を表示する|
|例外系列|a.2で入力したメールアドレスが既に登録してあるものを一致した場合<br>　a1.システムはエラーメッセージを表示する<br>　a2.基本系列1に戻る|
|事後条件|ユーザーの情報がシステムに登録され，ユーザーはログインすることができるようになる|

##### 3-2.　ユーザーをログイン状態にする

|項目|内容|
|:---|:---|
|概要|システムがユーザーを認証する|
|アクター|ユーザー|
|事前条件|ユーザーはアカウントを登録したことがある|
|基本系列|1.システムはログイン画面を表示する<br>2.ユーザーはメールアドレスとパスワードを入力する<br>3.システムは入力されたデータが正しいデータかどうかチェックする<br>4.システムはログイン完了画面を表示する|
|例外系列|a.2で入力されたデータが不足あるいは正しくなかった場合<br>　a1.システムはエラーメッセージを表示する<br>　a2.基本系列1に戻る|
|事後条件|ログインが成功し，ユーザーはシステムの機能が利用可能な状態になる|


##### 3-3. 大会名と試合段階を登録する

|項目|内容|
|:---|:---|
|概要|ユーザーが大会名と試合段階をシステムに登録する|
|アクター|ユーザー|
|事前条件||
|基本系列|1.システムは試合情報登録画面を表示する<br>2.ユーザーはID,大会名，試合段階を入力する<br>3.システムは試合情報を登録する<br>4.登録完了画面を表示する|
|例外系列|a.2で入力されたIDが既に登録されている<br>　a1.システムはエラーメッセージを表示する<br>　a2.基本系列1に戻る|
|事後条件|試合情報が登録され，結果入力の際に選択可能になる|

##### 3-4. 対戦相手を登録する

|項目|内容|
|:---|:---|
|概要|ユーザーが対戦相手をシステムに登録する|
|アクター|ユーザー|
|事前条件||
|基本系列|1.システムは対戦相手登録画面を表示する<br>2.ユーザーは相手名を入力する<br>3.システムは相手情報を登録する<br>4.システムは登録完了画面を表示する|
|例外系列|a.2で入力された相手が既に登録されている<br>　a1.システムはエラーメッセージを表示する<br>　a2.基本系列1に戻る|
|事後条件|相手情報が登録され，結果入力の際に選択可能になる|

##### 3-5. 対戦結果を登録する 

|項目|内容|
|:---|:---|
|概要|ユーザーが対戦結果をシステムに登録する|
|アクター|ユーザー|
|事前条件|登録したい対戦の大会名，試合段階，相手が登録してある|
|基本系列|1.システムは対戦結果登録画面を表示する<br>2.ユーザーは試合情報と相手情報を選択し，自身と相手の取ったセット数を入力する<br>3.システムは対戦結果を登録する<br>4.システムは登録完了画面を表示する|
|例外系列|a.2で入力されたセット数が5以上だった<br>　a1.システムはエラーメッセージを表示する<br>　a2.基本系列1に戻る|
|事後条件|対戦結果が登録され，検索可能になる|

##### 3-6. 対戦結果を検索する

|項目|内容|
|:---|:---|
|概要|ユーザーが対戦結果を検索する|
|アクター|ユーザー|
|事前条件|対戦相手が登録してある|
|基本系列|1.システムは対戦検索画面を表示する<br>2.ユーザーは検索したい対戦相手を選択する<br>3.システムは対戦情報を検索する<br>4.システムは検索結果画面を表示する|
|例外系列||
|事後条件||

##### 3-7. 対戦結果データを削除する

|項目|内容|
|:---|:---|
|概要|ユーザーが対戦結果データを削除する|
|アクター|ユーザー|
|事前条件|対戦結果が登録してある|
|基本系列|1.システムは対戦検索結果画面を表示する<br>2.ユーザーは削除したいデータを選択する<br>3.システムは対戦結果データを削除する<br>4.システムは検索画面を表示する|
|例外系列||
|事後条件|対戦結果データのみが削除され，試合情報および相手情報は削除されない．|


##### 3-8. ユーザーをログアウト状態にする

|項目|内容|
|:---|:---|
|概要|システムがユーザーのとグイン状態を切断する|
|アクター|ユーザー|
|事前条件|ユーザーがログインしている|
|基本系列|1.システムはマイページを表示する<br>2.ユーザーはログアウトを押す<br>3.システムはユーザーのログイン状態を切断する<br>4.システムはログアウト画面を表示する|
|例外系列||
|事後条件|ユーザーはシステムの機能が利用できない|


##### 3-9. ユーザーがパスワードを変更する

|項目|内容|
|:---|:---|
|概要|ユーザーがパスワードを変更する|
|アクター|ユーザー|
|事前条件|ユーザー情報が登録してある|
|基本系列|1.システムはパスワード変更画面を表示する<br>2.ユーザーは質問の答えと新しいパスワードを入力する<br>3.システムはユーザー情報の質問の答えが2で入力された答えと同じかどうかチェックする<br>4.システムはユーザー情報を更新する<br>5.システムはアカウント登録完了画面を表示する|
|例外系列|a.2で入力した質問の答えが間違っている<br>　a1.システムはエラーメッセージを表示する<br>　a2.基本系列1に戻る|
|事後条件|システムはユーザー情報を更新している|

### 4. データベース設計
##### 4-1. ユーザーデータベース(users)

|名前|説明|制約|備考|
|:---:|:---:|:---:|:---:|
|id|カラム特定のためのid|auto increment<br>primary key|-
|name|ユーザー名|not null<br>varchar 20|-
|mail|メールアドレス|not null<br>unique<br>varchar 255|-
|ps|パスワード|not null<br>varchar 255|-
|answer|質問の答え|not null<br>varchar 255|-
|created_at|作成日時|not null<br>date|-
|updated_at|更新日時|not null<br>date|-
|questions_id|秘密の質問|not null|外部キー

##### 4-2. 質問データベース(questions)

|名前|説明|制約|備考|
|:---:|:---:|:---:|:---:|
|id|カラム特定のためのID|primary key|-|
|content|質問内容|not null<br>varchar 255|-

##### 4-3. 戦績登録データベース(regists)

|名前|説明|制約|備考|
|:---:|:---:|:---:|:---:|
|id|カラム特定のためのid|auto increment<br>primary key|-
|match_id|登録する試合のid|not null|外部キー
|users_id|登録するユーザーのid|not null|外部キー

##### 4-4. 試合データベース(matches)

|名前|説明|制約|備考|
|:---:|:---:|:---:|:---:|
|id|カラム特定のためのid|primary key|-
|round|試合の段階|not null<br>varchar 30|-
|match_name|大会の名前|not null<br>varchar 30|-

##### 4-5. 対戦詳細データベース(results)

|名前|説明|制約|備考|
|:---:|:---:|:---:|:---:|
|id|カラム特定のためのid|auto increment<br>primary key|-
|my_score|自分の得点|not null<br>int|-
|opponent_score|相手の得点|not null<br>int|-
|match_id|登録する試合の詳細のid|not null|外部キー
|opponents_id|対戦した相手のid|not null|外部キー

##### 4-6. 対戦相手データベース(opponents)

|名前|説明|制約|備考|
|:---:|:---:|:---:|:---:|
|id|カラム特定のためのid|primary key<br>auto increment|-
|name|名前|not null<br>varchar 20|-
|users_id|登録するユーザーのid|not null|外部キー
